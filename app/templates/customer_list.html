{% extends "_dashboard_base.html" %}
{% block title %}Customers{% endblock %}
{% block nav_cust %}active{% endblock %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
  <h3 class="mb-0">Customers</h3>
</div>

<div class="table-responsive">
  <table class="table-people">
    <thead>
      <tr>
        <th>ID</th>
        <th>Customer</th>
        <th>Language</th>
        <th>Mobile Number</th>
        <th>Email</th>
        <th>Joined</th>
        <th>Status</th>
        <!-- <th>Loyalty Points</th> -->
        <th style="width:120px;">Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for c in customers %}
      {% set initials = (c.name or '').strip().split() %}
      {% set initials = (initials[0][0] ~ (initials[1][0] if initials|length>1 else '')).upper() if c.name else 'U' %}
      <tr>
        <!-- WhatsApp ID -->
        <td><strong>{{ c.id or "—" }}</strong></td>

        <!-- Customer with avatar -->
        <td>
          <div class="person">
            <div class="avatar">{{ initials }}</div>
            <div>
              <div>{{ c.name or "—" }}</div>
              <div class="muted">ID: {{ c.id }}</div>
            </div>
          </div>
        </td>

        <!-- Preferred Language -->
        <td>{{ c.preferred_language or "—" }}</td>

        <!-- Phone -->
        <td>
          {{ c.phone }}
        </td>

        <!-- Email -->
        <td>
          {{ c.email }}
        </td>

        <!-- Joined -->
        <td>{{ c.created_at.strftime("%d %b %Y") if c.created_at else "—" }}</td>

        <!-- Active status -->
        <td>
          {% if c.is_active %}
            <span class="chip-stock chip-in">Active</span>
          {% else %}
            <span class="chip-stock chip-out">Inactive</span>
          {% endif %}
        </td>

        <!-- Loyalty Points -->
        <!-- <td>{{ c.loyalty_points or 0 }}</td> -->

        <!-- Actions -->
        <td class="text-end">
          <a class="btn btn-ghost" href="/dashboard/customer/{{ c.id }}">View</a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
